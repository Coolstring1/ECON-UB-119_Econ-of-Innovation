ungroup() %>%
select(treated, operas_peryar_perregion, operas_total_peryar_perregion, yr00_20)
total_values = data.frame("yr00_20" = 2, "0" = operas_table$operas_total_peryar_perregion[1], "1" = operas_table$operas_total_peryar_perregion[2])
total_values <- total_values %>% rename("0" = X0, "1" = X1)
operas_table = operas_table %>%
select(-operas_total_peryar_perregion) %>%
spread(treated, operas_peryar_perregion)
operas_table <- rbind(operas_table,total_values)
View(operas)
operas_table_pop_Annals <- operas %>%
filter(year %in% 1781:1820 & annals = 1) %>% #drop the 1821 operas and include only those in the annals
mutate(yr00_20 = as.numeric(year>1800), #year is above 1801
treated = as.numeric(state %in% c("lombardy", "venetia"))) %>%
group_by(yr00_20, treated) %>%
summarise(operas_count = n(),
regions = n_distinct(state),
length = n_distinct(year)) %>%
mutate(operas_peryar_perregion = operas_count/(regions*length)) %>%
group_by(treated) %>%
mutate(operas_total_peryar_perregion = sum(operas_count)/(regions*length)) %>%
ungroup() %>%
select(treated, operas_peryar_perregion, operas_total_peryar_perregion, yr00_20)
operas_table_pop_Annals <- operas %>%
filter(year %in% 1781:1820 & annals = 1) #%>% #drop the 1821 operas and include only those in the annals
View(operas)
operas_table_pop_Annals <- operas %>%
filter(year %in% 1781:1820 & annals == 1) %>% #drop the 1821 operas and include only those in the annals
mutate(yr00_20 = as.numeric(year>1800), #year is above 1801
treated = as.numeric(state %in% c("lombardy", "venetia"))) %>%
group_by(yr00_20, treated) %>%
summarise(operas_count = n(),
regions = n_distinct(state),
length = n_distinct(year)) %>%
mutate(operas_peryar_perregion = operas_count/(regions*length)) %>%
group_by(treated) %>%
mutate(operas_total_peryar_perregion = sum(operas_count)/(regions*length)) %>%
ungroup() %>%
select(treated, operas_peryar_perregion, operas_total_peryar_perregion, yr00_20)
total_values = data.frame("yr00_20" = 2, "0" = operas_table$operas_total_peryar_perregion[1], "1" = operas_table$operas_total_peryar_perregion[2])
total_values_pop_Annals = data.frame("yr00_20" = 2,
"0" = operas_table_pop_Annals$operas_total_peryar_perregion[1],
"1" = operas_table_pop_Annals$operas_total_peryar_perregion[2])
View(total_values_pop_Annals)
total_values_pop_Annals <- total_values_pop_Annals %>% rename("0" = X0, "1" = X1)
total_values_pop_Annals <- total_values_pop_Annals %>% rename("0" = X0, "1" = X1)
operas_table_pop_Annals = operas_table_pop_Annals %>%
select(-operas_total_peryar_perregion) %>%
spread(treated, operas_peryar_perregion)
operas_table <- rbind(operas_table,total_values_pop_Annals)
#########
# Part 2: table
#########
# Please learn a new way to reshape. Maybe you'll like it better
# than the inbuilt one
operas_table <- operas %>%
filter(year %in% 1781:1820) %>% #drop the 1821 operas
mutate(yr00_20 = as.numeric(year>1800), #year is above 1801
treated = as.numeric(state %in% c("lombardy", "venetia"))) %>%
group_by(yr00_20, treated) %>%
summarise(operas_count = n(),
regions = n_distinct(state),
length = n_distinct(year)) %>%
mutate(operas_peryar_perregion = operas_count/(regions*length)) %>%
group_by(treated) %>%
mutate(operas_total_peryar_perregion = sum(operas_count)/(regions*length)) %>%
ungroup() %>%
select(treated, operas_peryar_perregion, operas_total_peryar_perregion, yr00_20)
total_values = data.frame("yr00_20" = 2,
"0" = operas_table$operas_total_peryar_perregion[1],
"1" = operas_table$operas_total_peryar_perregion[2])
total_values <- total_values %>% rename("0" = X0, "1" = X1)
operas_table = operas_table %>%
select(-operas_total_peryar_perregion) %>%
spread(treated, operas_peryar_perregion)
operas_table <- rbind(operas_table,total_values)
operas_table_pop_Annals <- operas %>%
filter(year %in% 1781:1820 & annals == 1) %>% #drop the 1821 operas and include only those in the annals
mutate(yr00_20 = as.numeric(year>1800), #year is above 1801
treated = as.numeric(state %in% c("lombardy", "venetia"))) %>%
group_by(yr00_20, treated) %>%
summarise(operas_count = n(),
regions = n_distinct(state),
length = n_distinct(year)) %>%
mutate(operas_peryar_perregion = operas_count/(regions*length)) %>%
group_by(treated) %>%
mutate(operas_total_peryar_perregion = sum(operas_count)/(regions*length)) %>%
ungroup() %>%
select(treated, operas_peryar_perregion, operas_total_peryar_perregion, yr00_20)
total_values_pop_Annals = data.frame("yr00_20" = 2,
"0" = operas_table_pop_Annals$operas_total_peryar_perregion[1],
"1" = operas_table_pop_Annals$operas_total_peryar_perregion[2])
total_values_pop_Annals <- total_values_pop_Annals %>% rename("0" = X0, "1" = X1)
operas_table_pop_Annals = operas_table_pop_Annals %>%
select(-operas_total_peryar_perregion) %>%
spread(treated, operas_peryar_perregion)
operas_table_pop_Annals <- rbind(operas_table_pop_Annals,total_values_pop_Annals)
View(operas_table_pop_Annals)
View(operas_table)
View(operas_table_pop_Annals)
operas_table_pop_Annals <- operas %>%
filter(year %in% 1781:1820 & annals == 1) %>% #drop the 1821 operas and include only those in the annals
mutate(yr00_20 = as.numeric(year>1800), #year is above 1801
treated = as.numeric(state %in% c("lombardy", "venetia"))) %>%
group_by(yr00_20, treated) %>%
summarise(operas_count = n(),
regions = n_distinct(state),
length = n_distinct(year)) %>%
mutate(operas_peryar_perregion = operas_count/(regions*length)) %>%
group_by(treated) %>%
mutate(operas_total_peryar_perregion = sum(operas_count)/(regions*length)) %>%
ungroup() %>%
select(treated, operas_peryar_perregion, operas_total_peryar_perregion, yr00_20)
View(operas_table_pop_Annals)
View(operas_table)
total_values_pop_Annals = data.frame("yr00_20" = 2,
"0" = operas_table_pop_Annals$operas_total_peryar_perregion[1],
"1" = operas_table_pop_Annals$operas_total_peryar_perregion[2])
total_values_pop_Annals <- total_values_pop_Annals %>% rename("0" = X0, "1" = X1)
operas_table_pop_Annals = operas_table_pop_Annals %>%
select(-operas_total_peryar_perregion) %>%
spread(treated, operas_peryar_perregion)
operas_table_pop_Annals <- rbind(operas_table_pop_Annals,total_values_pop_Annals)
operas_table_pop_Annals <- operas %>%
filter(year %in% 1781:1820 & annals == 1) %>% #drop the 1821 operas and include only those in the annals
mutate(yr00_20 = as.numeric(year>1800), #year is above 1801
treated = as.numeric(state %in% c("lombardy", "venetia"))) #%>%
View(operas_table_pop_Annals)
operas_table_pop_Annals <- operas %>%
filter(year %in% 1781:1820 & annals == 1) %>% #drop the 1821 operas and include only those in the annals
mutate(yr00_20 = as.numeric(year>1800), #year is above 1801
treated = as.numeric(state %in% c("lombardy", "venetia"))) %>%
group_by(yr00_20, treated) %>%
summarise(operas_count = n(),
regions = n_distinct(state),
length = n_distinct(year)) #%>%
View(operas_table_pop_Annals)
operas_table_pop_Annals <- operas %>%
filter(year %in% 1781:1820 & annals == 1) %>% #drop the 1821 operas and include only those in the annals
mutate(yr00_20 = as.numeric(year>1800), #year is above 1801
treated = as.numeric(state %in% c("lombardy", "venetia"))) %>%
group_by(yr00_20, treated) %>%
summarise(operas_count = n(),
regions = case_when(treated == 0 ~ 6,treated == 1 ~ 2),
length = 20) #%>%
View(operas_table_all)
View(operas_table)
View(operas_c)
#########
# Part 2: table
#########
# Please learn a new way to reshape. Maybe you'll like it better
# than the inbuilt one
operas_table <- operas %>%
filter(year %in% 1781:1820) %>% #drop the 1821 operas
mutate(yr00_20 = as.numeric(year>1800), #year is above 1801
treated = as.numeric(state %in% c("lombardy", "venetia"))) %>%
group_by(yr00_20, treated) %>%
summarise(operas_count = n(),
regions = n_distinct(state),
length = n_distinct(year)) #%>%
View(operas_table)
#########
# Part 2: table
#########
# Please learn a new way to reshape. Maybe you'll like it better
# than the inbuilt one
operas_table <- operas %>%
filter(year %in% 1781:1820) %>% #drop the 1821 operas
mutate(yr00_20 = as.numeric(year>1800), #year is above 1801
treated = as.numeric(state %in% c("lombardy", "venetia"))) %>%
group_by(yr00_20, treated) %>%
summarise(operas_count = n(),
regions = n_distinct(state),
length = n_distinct(year)) %>%
mutate(operas_peryar_perregion = operas_count/(regions*length)) %>%
group_by(treated) %>%
mutate(operas_total_peryar_perregion = sum(operas_count)/(regions*length)) %>%
ungroup() %>%
select(treated, operas_peryar_perregion, operas_total_peryar_perregion, yr00_20)
total_values = data.frame("yr00_20" = 2,
"0" = operas_table$operas_total_peryar_perregion[1],
"1" = operas_table$operas_total_peryar_perregion[2])
total_values <- total_values %>% rename("0" = X0, "1" = X1)
operas_table = operas_table %>%
select(-operas_total_peryar_perregion) %>%
spread(treated, operas_peryar_perregion)
operas_table <- rbind(operas_table,total_values)
operas_table_pop_Annals <- operas %>%
filter(year %in% 1781:1820 & annals == 1) %>% #drop the 1821 operas and include only those in the annals
mutate(yr00_20 = as.numeric(year>1800), #year is above 1801
treated = as.numeric(state %in% c("lombardy", "venetia"))) %>%
group_by(yr00_20, treated) %>%
summarise(operas_count = n(),
regions = case_when(treated == 0 ~ 6,treated == 1 ~ 2),
length = 20) #%>%
operas_table_pop_Annals <- operas %>%
filter(year %in% 1781:1820 & annals == 1) %>% #drop the 1821 operas and include only those in the annals
mutate(yr00_20 = as.numeric(year>1800), #year is above 1801
treated = as.numeric(state %in% c("lombardy", "venetia"))) %>%
group_by(yr00_20, treated) %>%
summarise(operas_count = n(),
regions = case_when(treated == 0 ~ 6,treated == 1 ~ 2),
length = 20) %>%
mutate(operas_peryar_perregion = operas_count/(regions*length)) %>%
group_by(treated) %>%
mutate(operas_total_peryar_perregion = sum(operas_count)/(regions*length)) %>%
ungroup() %>%
select(treated, operas_peryar_perregion, operas_total_peryar_perregion, yr00_20)
View(operas_table_pop_Annals)
operas_table_pop_Annals <- operas %>%
filter(year %in% 1781:1820 & annals == 1) %>% #drop the 1821 operas and include only those in the annals
mutate(yr00_20 = as.numeric(year>1800), #year is above 1801
treated = as.numeric(state %in% c("lombardy", "venetia"))) %>%
group_by(yr00_20, treated) %>%
summarise(operas_count = n(),
regions = case_when(treated == 0 ~ 6,treated == 1 ~ 2),
length = 20) %>%
mutate(operas_peryar_perregion = operas_count/(regions*length)) %>%
group_by(treated) %>%
mutate(operas_total_peryar_perregion = sum(operas_count)/(regions*length)) %>%
ungroup() %>%
select(treated, operas_peryar_perregion, operas_total_peryar_perregion, yr00_20) %>%
distinct()
View(operas_table_pop_Annals)
total_values_pop_Annals <- total_values_pop_Annals %>% rename("0" = X0, "1" = X1)
total_values_pop_Annals = data.frame("yr00_20" = 2,
"0" = operas_table_pop_Annals$operas_total_peryar_perregion[1],
"1" = operas_table_pop_Annals$operas_total_peryar_perregion[2])
total_values_pop_Annals <- total_values_pop_Annals %>% rename("0" = X0, "1" = X1)
operas_table_pop_Annals = operas_table_pop_Annals %>%
select(-operas_total_peryar_perregion) %>%
spread(treated, operas_peryar_perregion)
operas_table_pop_Annals <- rbind(operas_table_pop_Annals,total_values_pop_Annals)
View(operas_table_pop_Annals)
operas_table_pop_Annals <- operas %>%
filter(year %in% 1781:1820 & annals == 1) %>% #drop the 1821 operas and include only those in the annals
mutate(yr00_20 = as.numeric(year>1800), #year is above 1801
treated = as.numeric(state %in% c("lombardy", "venetia"))) %>%
group_by(yr00_20, treated) %>%
summarise(operas_count = n(),
regions = case_when(treated == 0 ~ 6,treated == 1 ~ 2),
length = 20) %>%
mutate(operas_peryar_perregion = operas_count/(regions*length)) %>%
group_by(treated) #%>%
View(operas_table_pop_Annals)
operas_table_pop_Annals <- operas %>%
filter(year %in% 1781:1820 & annals == 1) %>% #drop the 1821 operas and include only those in the annals
mutate(yr00_20 = as.numeric(year>1800), #year is above 1801
treated = as.numeric(state %in% c("lombardy", "venetia"))) %>%
group_by(yr00_20, treated) %>%
summarise(operas_count = n(),
regions = case_when(treated == 0 ~ 6,treated == 1 ~ 2),
length = 20) %>%
mutate(operas_peryar_perregion = operas_count/(regions*length)) %>%
group_by(treated) %>%
mutate(operas_total_peryar_perregion = sum(operas_count)/(regions*length)) #%>%
View(operas_table_pop_Annals)
operas_table_pop_Annals <- operas %>%
filter(year %in% 1781:1820 & annals == 1) %>% #drop the 1821 operas and include only those in the annals
mutate(yr00_20 = as.numeric(year>1800), #year is above 1801
treated = as.numeric(state %in% c("lombardy", "venetia"))) %>%
group_by(yr00_20, treated) %>%
summarise(operas_count = n(),
regions = case_when(treated == 0 ~ 6,treated == 1 ~ 2),
length = 20) %>%
mutate(operas_peryar_perregion = operas_count/(regions*length)) %>%
group_by(treated) %>%
mutate(operas_total_peryar_perregion = operas_count/(regions*length)) #%>%
View(operas_table_pop_Annals)
operas_table_pop_Annals <- operas %>%
filter(year %in% 1781:1820 & annals == 1) %>% #drop the 1821 operas and include only those in the annals
mutate(yr00_20 = as.numeric(year>1800), #year is above 1801
treated = as.numeric(state %in% c("lombardy", "venetia"))) %>%
group_by(yr00_20, treated) %>%
summarise(operas_count = n(),
regions = case_when(treated == 0 ~ 6,treated == 1 ~ 2),
length = 20) %>%
mutate(operas_peryar_perregion = operas_count/(regions*length)) %>%
group_by(treated) %>%
mutate(operas_total_peryar_perregion = sum(operas_count)/(regions*length)) #%>%
operas_table_pop_Annals <- operas %>%
filter(year %in% 1781:1820 & annals == 1) %>% #drop the 1821 operas and include only those in the annals
mutate(yr00_20 = as.numeric(year>1800), #year is above 1801
treated = as.numeric(state %in% c("lombardy", "venetia"))) %>%
group_by(yr00_20, treated) %>%
summarise(operas_count = n(),
regions = case_when(treated == 0 ~ 6,treated == 1 ~ 2),
length = 20) %>%
mutate(operas_peryar_perregion = operas_count/(regions*length)) %>%
group_by(treated) %>%
mutate(operas_total_peryar_perregion = sum(operas_count)/(regions*length)) %>%
ungroup() %>%
select(treated, operas_peryar_perregion, operas_total_peryar_perregion, yr00_20) %>%
distinct()
#########
# Part 2: table
#########
# Please learn a new way to reshape. Maybe you'll like it better
# than the inbuilt one
operas_table <- operas %>%
filter(year %in% 1781:1820) %>% #drop the 1821 operas
mutate(yr00_20 = as.numeric(year>1800), #year is above 1801
treated = as.numeric(state %in% c("lombardy", "venetia"))) %>%
group_by(yr00_20, treated) %>%
summarise(operas_count = n(),
regions = n_distinct(state),
length = n_distinct(year)) %>%
mutate(operas_peryar_perregion = operas_count/(regions*length)) %>%
group_by(treated) %>%
mutate(operas_total_peryar_perregion = sum(operas_count)/(regions*length)) #%>%
View(operas_table)
#########
# Part 2: table
#########
# Please learn a new way to reshape. Maybe you'll like it better
# than the inbuilt one
operas_table <- operas %>%
filter(year %in% 1781:1820) %>% #drop the 1821 operas
mutate(yr00_20 = as.numeric(year>1800), #year is above 1801
treated = as.numeric(state %in% c("lombardy", "venetia"))) %>%
group_by(yr00_20, treated) %>%
summarise(operas_count = n(),
regions = n_distinct(state),
length = n_distinct(year)) %>%
mutate(operas_peryar_perregion = operas_count/(regions*length)) %>%
group_by(treated) %>%
mutate(operas_total_peryar_perregion = sum(operas_count)/(regions*length)) #%>%
#########
# Part 2: table
#########
# Please learn a new way to reshape. Maybe you'll like it better
# than the inbuilt one
operas_table <- operas %>%
filter(year %in% 1781:1820) %>% #drop the 1821 operas
mutate(yr00_20 = as.numeric(year>1800), #year is above 1801
treated = as.numeric(state %in% c("lombardy", "venetia"))) %>%
group_by(yr00_20, treated) %>%
summarise(operas_count = n(),
regions = n_distinct(state),
length = n_distinct(year)) %>%
mutate(operas_peryar_perregion = operas_count/(regions*length)) %>%
group_by(treated) %>%
mutate(operas_total_peryar_perregion = sum(operas_count)/(regions*length)) #%>%
View(operas_table)
#########
# Part 2: table
#########
# Please learn a new way to reshape. Maybe you'll like it better
# than the inbuilt one
operas_table <- operas %>%
filter(year %in% 1781:1820) %>% #drop the 1821 operas
mutate(yr00_20 = as.numeric(year>1800), #year is above 1801
treated = as.numeric(state %in% c("lombardy", "venetia"))) %>%
group_by(yr00_20, treated) %>%
summarise(operas_count = n(),
regions = n_distinct(state),
length = n_distinct(year)) %>%
mutate(operas_peryar_perregion = operas_count/(regions*length)) %>%
group_by(treated) %>%
mutate(operas_total_peryar_perregion = sum(operas_count)/(regions*length)) %>%
ungroup() %>%
select(treated, operas_peryar_perregion, operas_total_peryar_perregion, yr00_20)
operas_table_pop_Annals <- operas %>%
filter(year %in% 1781:1820 & annals == 1) %>% #drop the 1821 operas and include only those in the annals
mutate(yr00_20 = as.numeric(year>1800), #year is above 1801
treated = as.numeric(state %in% c("lombardy", "venetia"))) %>%
group_by(yr00_20, treated) %>%
summarise(operas_count = n(),
regions = case_when(treated == 0 ~ 6,treated == 1 ~ 2),
length = 20) %>%
mutate(operas_peryar_perregion = operas_count/(regions*length)) %>%
group_by(treated) #%>%
View(operas_table_pop_Annals)
mutate(operas_total_peryar_perregion = mean(operas_count/(regions*length))) %>%
ungroup() %>%
select(treated, operas_peryar_perregion, operas_total_peryar_perregion, yr00_20)
sum(
mutate(operas_total_peryar_perregion = mean(sum(operas_count)/(regions*length))) %>%
ungroup() %>%
select(treated, operas_peryar_perregion, operas_total_peryar_perregion, yr00_20)
View(operas_table_pop_Annals)
View(operas_table_pop_Annals)
operas_table_pop_Annals <- operas %>%
filter(year %in% 1781:1820 & annals == 1) %>% #drop the 1821 operas and include only those in the annals
mutate(yr00_20 = as.numeric(year>1800), #year is above 1801
treated = as.numeric(state %in% c("lombardy", "venetia"))) %>%
group_by(yr00_20, treated) %>%
summarise(operas_count = n(),
regions = case_when(treated == 0 ~ 6,treated == 1 ~ 2),
length = 20) %>%
mutate(operas_peryar_perregion = operas_count/(regions*length)) %>%
group_by(treated) %>%
mutate(operas_total_peryar_perregion = mean(sum(operas_count)/(regions*length))) #%>%
View(operas_table_pop_Annals)
operas_table_pop_Annals <- operas %>%
filter(year %in% 1781:1820 & annals == 1) %>% #drop the 1821 operas and include only those in the annals
mutate(yr00_20 = as.numeric(year>1800), #year is above 1801
treated = as.numeric(state %in% c("lombardy", "venetia"))) %>%
group_by(yr00_20, treated) %>%
summarise(operas_count = n(),
regions = case_when(treated == 0 ~ 6,treated == 1 ~ 2),
length = 20) %>%
mutate(operas_peryar_perregion = operas_count/(regions*length)) %>%
group_by(treated) %>%
mutate(operas_total_peryar_perregion = sum(operas_count)/(regions*length)) #%>%
View(operas_table_pop_Annals)
operas_table_pop_Annals <- operas %>%
filter(year %in% 1781:1820 & annals == 1) %>% #drop the 1821 operas and include only those in the annals
mutate(yr00_20 = as.numeric(year>1800), #year is above 1801
treated = as.numeric(state %in% c("lombardy", "venetia"))) %>%
group_by(yr00_20, treated) %>%
summarise(operas_count = n(),
regions = case_when(treated == 0 ~ 6,treated == 1 ~ 2),
length = 20) %>%
mutate(operas_peryar_perregion = operas_count/(regions*length)) %>%
group_by(treated) %>%
mutate(operas_total_peryar_perregion = sum(operas_count)/(regions*length)) #%>%
ungroup() %>%
select(treated, operas_peryar_perregion, operas_total_peryar_perregion, yr00_20)
operas_table_pop_Annals <- operas %>%
filter(year %in% 1781:1820 & annals == 1) %>% #drop the 1821 operas and include only those in the annals
mutate(yr00_20 = as.numeric(year>1800), #year is above 1801
treated = as.numeric(state %in% c("lombardy", "venetia"))) %>%
group_by(yr00_20, treated) %>%
summarise(operas_count = n(),
regions = case_when(treated == 0 ~ 6,treated == 1 ~ 2),
length = 20) %>%
mutate(operas_peryar_perregion = operas_count/(regions*length)) %>%
group_by(treated) %>%
mutate(operas_total_peryar_perregion = sum(operas_count)/(regions*length)) %>%
ungroup() %>%
select(treated, operas_peryar_perregion, operas_total_peryar_perregion, yr00_20)
total_values_pop_Annals = data.frame("yr00_20" = 2,
"0" = operas_table_pop_Annals$operas_total_peryar_perregion[1],
"1" = operas_table_pop_Annals$operas_total_peryar_perregion[2])
total_values_pop_Annals <- total_values_pop_Annals %>% rename("0" = X0, "1" = X1)
operas_table_pop_Annals = operas_table_pop_Annals %>%
select(-operas_total_peryar_perregion) %>%
spread(treated, operas_peryar_perregion)
operas_table_pop_Annals <- operas %>%
filter(year %in% 1781:1820 & annals == 1) %>% #drop the 1821 operas and include only those in the annals
mutate(yr00_20 = as.numeric(year>1800), #year is above 1801
treated = as.numeric(state %in% c("lombardy", "venetia"))) %>%
group_by(yr00_20, treated) %>%
summarise(operas_count = n(),
regions = case_when(treated == 0 ~ 6,treated == 1 ~ 2),
length = 20) %>%
mutate(operas_peryar_perregion = operas_count/(regions*length)) %>%
group_by(treated) %>%
mutate(operas_total_peryar_perregion = sum(operas_count)/(regions*length)) %>%
ungroup() %>%
select(treated, operas_peryar_perregion, operas_total_peryar_perregion, yr00_20) %>%
distinct()
total_values_pop_Annals = data.frame("yr00_20" = 2,
"0" = operas_table_pop_Annals$operas_total_peryar_perregion[1],
"1" = operas_table_pop_Annals$operas_total_peryar_perregion[2])
total_values_pop_Annals <- total_values_pop_Annals %>% rename("0" = X0, "1" = X1)
operas_table_pop_Annals = operas_table_pop_Annals %>%
select(-operas_total_peryar_perregion) %>%
spread(treated, operas_peryar_perregion)
operas_table_pop_Annals <- rbind(operas_table_pop_Annals,total_values_pop_Annals)
View(operas_table_pop_Annals)
View(operas_table)
View(operas_table_all)
#########
# Part 2: table
#########
# Please learn a new way to reshape. Maybe you'll like it better
# than the inbuilt one
operas_table <- operas %>%
filter(year %in% 1781:1820) %>% #drop the 1821 operas
mutate(yr00_20 = as.numeric(year>1800), #year is above 1801
treated = as.numeric(state %in% c("lombardy", "venetia"))) %>%
group_by(yr00_20, treated) %>%
summarise(operas_count = n(),
regions = n_distinct(state),
length = n_distinct(year)) %>%
mutate(operas_peryar_perregion = operas_count/(regions*length)) %>%
group_by(treated) %>%
mutate(operas_total_peryar_perregion = sum(operas_count)/(regions*length)) %>%
ungroup() %>%
select(treated, operas_peryar_perregion, operas_total_peryar_perregion, yr00_20)
total_values = data.frame("yr00_20" = 2,
"0" = operas_table$operas_total_peryar_perregion[1],
"1" = operas_table$operas_total_peryar_perregion[2])
total_values <- total_values %>% rename("0" = X0, "1" = X1)
operas_table = operas_table %>%
select(-operas_total_peryar_perregion) %>%
spread(treated, operas_peryar_perregion)
operas_table <- rbind(operas_table,total_values)
operas_table_pop_Annals <- operas %>%
filter(year %in% 1781:1820 & annals == 1) %>% #drop the 1821 operas and include only those in the annals
mutate(yr00_20 = as.numeric(year>1800), #year is above 1801
treated = as.numeric(state %in% c("lombardy", "venetia"))) %>%
group_by(yr00_20, treated) %>%
summarise(operas_count = n(),
regions = case_when(treated == 0 ~ 6,treated == 1 ~ 2),
length = 20) %>%
mutate(operas_peryar_perregion = operas_count/(regions*length)) %>%
group_by(treated) %>%
mutate(operas_total_peryar_perregion = sum(operas_count)/(regions*length)) %>%
ungroup() %>%
select(treated, operas_peryar_perregion, operas_total_peryar_perregion, yr00_20) %>%
distinct()
total_values_pop_Annals = data.frame("yr00_20" = 2,
"0" = operas_table_pop_Annals$operas_total_peryar_perregion[1],
"1" = operas_table_pop_Annals$operas_total_peryar_perregion[2])
total_values_pop_Annals <- total_values_pop_Annals %>% rename("0" = X0, "1" = X1)
operas_table_pop_Annals = operas_table_pop_Annals %>%
select(-operas_total_peryar_perregion) %>%
spread(treated, operas_peryar_perregion)
operas_table_pop_Annals <- rbind(operas_table_pop_Annals,total_values_pop_Annals)
